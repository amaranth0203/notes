http://bbs.pediy.com/showthread.php?t=187021
3楼
时隔10年，我依然用扭曲PE格式+自定义内存loader的方式处理免杀。

杀毒软件扫描病毒首先要根据一个重要的事情是PE文件，如果源文件不是PE,那么它的一切静态扫描和动态扫描都是没用。

PE扭曲后，写一个加载器来加载，然后加载器本身使用的API尽量不敏感，如加载器使用的API,其中有LoadLibrary这种敏感词，怎么办呢？其实很简单，自己写个搜索导出表的代码（汇编代码尽量做好免杀就好），然后从FS:[0]里PEB里撸出Kernel32（这段代码需要二进制扭曲，什么是二进制扭曲，就是把机器码拆分成add [reg],x;or [reg],y的形式来填写机器码），然后就没啥了，内存加载运行PE这种东西毕竟被撸烂了，至于怎么扭曲PE结构，再还原PE结构内存加载，这些都是个人研究了。 